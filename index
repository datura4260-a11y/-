<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>çŒ«çŒ«æŠ½å¡ v3.1ï¼ˆå«æ¦‚ç‡å…¬ç¤ºï¼‰</title>
<style>
  body {
    font-family: "Segoe UI", sans-serif;
    background: linear-gradient(180deg, #fdfbfb, #ebedee);
    text-align: center;
    padding: 40px 20px;
  }

  .top-bar {
    position: fixed;
    top: 20px;
    right: 20px;
    background: white;
    border-radius: 12px;
    padding: 10px 16px;
    box-shadow: 0 3px 8px rgba(0,0,0,0.15);
    font-size: 16px;
    line-height: 1.6;
    text-align: left;
  }

  /* å·¦ä¾§æ¦‚ç‡è¯´æ˜é¢æ¿ */
  .info-bar {
    position: fixed;
    top: 20px;
    left: 20px;
    background: #ffffff;
    border-radius: 12px;
    padding: 14px 18px;
    box-shadow: 0 3px 8px rgba(0,0,0,0.15);
    font-size: 14px;
    line-height: 1.8;
    text-align: left;
    width: 260px;
  }

  .info-bar h2 {
    font-size: 16px;
    margin-top: 0;
    color: #333;
    text-align: center;
  }

  .info-bar ul {
    list-style: none;
    padding-left: 0;
    margin: 5px 0 10px 0;
  }

  .info-bar li {
    margin-bottom: 3px;
  }

  .info-bar strong {
    color: #4CAF50;
  }

  .card-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 15px;
    margin-top: 100px;
  }

  .card {
    width: 120px;
    height: 180px;
    perspective: 600px;
  }

  .card-inner {
    width: 100%;
    height: 100%;
    position: relative;
    transition: transform 0.6s;
    transform-style: preserve-3d;
  }

  .card.flip .card-inner {
    transform: rotateY(180deg);
  }

  .card-front, .card-back {
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 10px;
    backface-visibility: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 16px;
    font-weight: bold;
    color: #333;
    border: 2px solid #999;
  }

  .card-front {
    background: #fff;
  }

  .card-back {
    background: #4CAF50;
    color: white;
    transform: rotateY(180deg);
  }

  .shine {
    animation: shine 1s ease-out;
  }

  @keyframes shine {
    0% { box-shadow: 0 0 5px rgba(255,215,0,0.2); }
    50% { box-shadow: 0 0 30px rgba(255,215,0,1); }
    100% { box-shadow: 0 0 5px rgba(255,215,0,0.2); }
  }

  .buttons {
    margin-top: 40px;
  }

  button {
    padding: 10px 18px;
    margin: 0 8px;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
    color: white;
    background: linear-gradient(180deg,#4caf50,#3b9d42);
  }

  button:disabled {
    background: gray;
    cursor: not-allowed;
  }

  .message {
    margin-top: 20px;
    font-size: 16px;
    color: #444;
  }
</style>
</head>
<body>

<h1>ğŸ± çŒ«çŒ«æŠ½å¡ v3.1 ğŸ¾</h1>

<!-- å·¦ä¾§æ¦‚ç‡æ  -->
<div class="info-bar">
  <h2>ğŸ² æ¦‚ç‡ä¸€è§ˆ</h2>
  <ul>
    <li><strong>å¥–å¥–å¥–ï½</strong>ï¼š0.06%</li>
    <li><strong>ä¸€æ ¹çŒ«æ¯›</strong>ï¼š2.76%</li>
    <li><strong>å†æŠ½ä¸€æ¬¡</strong>ï¼š28.65%</li>
    <li><strong>è°¢è°¢æƒ é¡¾</strong>ï¼š68.53%</li>
  </ul>
  <h2>ğŸ“œ ä¿åº•è§„åˆ™</h2>
  <ul>
    <li>æ¯ 5 æŠ½ï¼šè‡³å°‘è·å¾—ä¸€æ¬¡â€œå†æŠ½ä¸€æ¬¡â€æˆ–æ›´å¥½ã€‚</li>
    <li>æ¯ 50 æŠ½ï¼šå¿…å¾—â€œä¸€æ ¹çŒ«æ¯›â€æˆ–æ›´å¥½ã€‚</li>
  </ul>
</div>

<!-- å³ä¾§ç»Ÿè®¡ -->
<div class="top-bar" id="stats">
  å‰©ä½™æŠ½å¡æ¬¡æ•°ï¼š20<br>
  ä¸€æ ¹çŒ«æ¯›ï¼š0<br>
  çŒ«çŒ«å¤§äººæ°¸è¿œä¸ç¼ºç¤¼ç‰©ï¼š0
</div>

<!-- å¡ç‰ŒåŒº -->
<div class="card-container" id="container"></div>

<!-- æŒ‰é’® -->
<div class="buttons">
  <button id="draw1">æŠ½ä¸€æ¬¡</button>
  <button id="draw10">æŠ½åæ¬¡</button>
</div>

<div class="message" id="msg"></div>

<script>
let remaining = 20;
let catHair = 0;
let bigGift = 0;
let drawsSinceRare = 0;
let drawsSinceEpic = 0;

const container = document.getElementById("container");
const stats = document.getElementById("stats");
const msg = document.getElementById("msg");
const draw1 = document.getElementById("draw1");
const draw10 = document.getElementById("draw10");

// æ›´æ–°ç»Ÿè®¡
function updateStats() {
  stats.innerHTML = `å‰©ä½™æŠ½å¡æ¬¡æ•°ï¼š${remaining}<br>ä¸€æ ¹çŒ«æ¯›ï¼š${catHair}<br>çŒ«çŒ«å¤§äººæ°¸è¿œä¸ç¼ºç¤¼ç‰©ï¼š${bigGift}`;
  if (remaining <= 0) {
    draw1.disabled = true;
    draw10.disabled = true;
    setTimeout(() => {
      alert(`æŠ½å¡ç»“æŸï¼\næœ¬æ¬¡å…±è·å¾—ï¼š\nä¸€æ ¹çŒ«æ¯›ï¼š${catHair}\nçŒ«çŒ«å¤§äººæ°¸è¿œä¸ç¼ºç¤¼ç‰©ï¼š${bigGift}`);
    }, 800);
  }
}

// æŠ½å¡ç»“æœè®¡ç®—ï¼ˆå«ä¿åº•é€»è¾‘ï¼‰
function drawResult() {
  const p = Math.random() * 100;
  let result;
  if (p < 0.06) result = "å¥–å¥–å¥–ï½";
  else if (p < 2.82) result = "ä¸€æ ¹çŒ«æ¯›";
  else if (p < 31.47) result = "å†æŠ½ä¸€æ¬¡";
  else result = "è°¢è°¢æƒ é¡¾";

  // æ›´æ–°ä¿åº•è®¡æ•°
  if (result === "è°¢è°¢æƒ é¡¾") {
    drawsSinceRare++;
    drawsSinceEpic++;
  } else {
    drawsSinceRare = 0;
    if (result === "ä¸€æ ¹çŒ«æ¯›" || result === "å¥–å¥–å¥–ï½") drawsSinceEpic = 0;
    else drawsSinceEpic++;
  }

  // 50 æŠ½ä¿åº•çŒ«æ¯›
  if (drawsSinceEpic >= 49) {
    drawsSinceEpic = 0;
    result = "ä¸€æ ¹çŒ«æ¯›";
  }

  // 5 æŠ½ä¿åº•ç¨€æœ‰
  if (drawsSinceRare >= 5) {
    drawsSinceRare = 0;
    result = "å†æŠ½ä¸€æ¬¡";
  }

  return result;
}

// åŠ¨ç”»ç”Ÿæˆå¡ç‰‡
function createCard(result, delay) {
  const card = document.createElement("div");
  card.className = "card";
  const inner = document.createElement("div");
  inner.className = "card-inner";
  const front = document.createElement("div");
  front.className = "card-front";
  front.textContent = "æŠ½å¡ä¸­...";
  const back = document.createElement("div");
  back.className = "card-back";
  back.textContent = result;

  inner.appendChild(front);
  inner.appendChild(back);
  card.appendChild(inner);
  container.appendChild(card);

  setTimeout(() => {
    card.classList.add("flip");
    if (result === "ä¸€æ ¹çŒ«æ¯›" || result === "å¥–å¥–å¥–ï½") {
      back.classList.add("shine");
    }
  }, delay);
}

// ä¸»æŠ½å¡é€»è¾‘
function draw(times) {
  if (remaining <= 0) return;
  let actual = Math.min(times, remaining);
  msg.textContent = `æŠ½${actual}æ¬¡ä¸­...`;
  draw1.disabled = true;
  draw10.disabled = true;
  container.innerHTML = "";

  for (let i = 0; i < actual; i++) {
    const result = drawResult();
    remaining--;

    if (result === "å†æŠ½ä¸€æ¬¡") remaining++;
    if (result === "ä¸€æ ¹çŒ«æ¯›") catHair++;
    if (result === "å¥–å¥–å¥–ï½") bigGift++;

    createCard(result, i * 250);
  }

  setTimeout(() => {
    draw1.disabled = remaining <= 0;
    draw10.disabled = remaining <= 0;
    updateStats();
    msg.textContent = "æŠ½å®Œå•¦ï½";
  }, actual * 250 + 1000);
}

draw1.onclick = () => draw(1);
draw10.onclick = () => draw(10);
updateStats();
</script>

</body>
</html>
